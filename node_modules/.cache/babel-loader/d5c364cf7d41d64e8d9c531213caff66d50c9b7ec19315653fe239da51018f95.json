{"ast":null,"code":"import * as XLSX from \"xlsx\";\nimport { saveAs } from \"file-saver\";\nconst handleExport = () => {\n  const headers = [\"Sr No.\", \"Name\", \"Base Salary\", \"HRA\", \"Conveyance\", \"Attendance (Days)\", \"Net Payable\", \"CTC\"];\n  const rows = filteredAndSortedEmployees.map((emp, index) => [index + 1, emp.name, emp.base || 0, emp.hra || 0, emp.conveyance || 0, `${emp.attendanceDays}/${emp.totalDays}`, calculateNetPayable(emp) || 0, calculateCTC(emp) || 0]);\n  const worksheetData = [headers, ...rows];\n  const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);\n  const workbook = XLSX.utils.book_new();\n  XLSX.utils.book_append_sheet(workbook, worksheet, \"Employee Salary\");\n  worksheet[\"!cols\"] = [{\n    wch: 8\n  },\n  // Sr No\n  {\n    wch: 25\n  },\n  // Name\n  {\n    wch: 15\n  },\n  // Base Salary\n  {\n    wch: 10\n  },\n  // HRA\n  {\n    wch: 15\n  },\n  // Conveyance\n  {\n    wch: 18\n  },\n  // Attendance (Days)\n  {\n    wch: 15\n  },\n  // Net Payable\n  {\n    wch: 10\n  } // CTC\n  ];\n\n  // Generate Excel file\n  const excelBuffer = XLSX.write(workbook, {\n    bookType: \"xlsx\",\n    type: \"array\"\n  });\n  const blob = new Blob([excelBuffer], {\n    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n  });\n\n  // Save the file\n  saveAs(blob, `Employee_Salary_${selectedMonth}_${selectedYear}.xlsx`);\n};\nexport default handleExport;","map":{"version":3,"names":["XLSX","saveAs","handleExport","headers","rows","filteredAndSortedEmployees","map","emp","index","name","base","hra","conveyance","attendanceDays","totalDays","calculateNetPayable","calculateCTC","worksheetData","worksheet","utils","aoa_to_sheet","workbook","book_new","book_append_sheet","wch","excelBuffer","write","bookType","type","blob","Blob","selectedMonth","selectedYear"],"sources":["C:/Users/pc/Desktop/HR/hr-frontend/src/service/Export.js"],"sourcesContent":["import * as XLSX from \"xlsx\";\r\nimport { saveAs } from \"file-saver\";\r\n\r\nconst handleExport = () => {\r\n  const headers = [\r\n    \"Sr No.\",\r\n    \"Name\",\r\n    \"Base Salary\",\r\n    \"HRA\",\r\n    \"Conveyance\",\r\n    \"Attendance (Days)\",\r\n    \"Net Payable\",\r\n    \"CTC\"\r\n  ];\r\n\r\n  const rows = filteredAndSortedEmployees.map((emp, index) => [\r\n    index + 1,\r\n    emp.name,\r\n    emp.base || 0,\r\n    emp.hra || 0,\r\n    emp.conveyance || 0,\r\n    `${emp.attendanceDays}/${emp.totalDays}`,\r\n    calculateNetPayable(emp) || 0,\r\n    calculateCTC(emp) || 0\r\n  ]);\r\n\r\n\r\n  const worksheetData = [headers, ...rows];\r\n\r\n \r\n  const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);\r\n  const workbook = XLSX.utils.book_new();\r\n  XLSX.utils.book_append_sheet(workbook, worksheet, \"Employee Salary\");\r\n\r\n\r\n  worksheet[\"!cols\"] = [\r\n    { wch: 8 },  // Sr No\r\n    { wch: 25 }, // Name\r\n    { wch: 15 }, // Base Salary\r\n    { wch: 10 }, // HRA\r\n    { wch: 15 }, // Conveyance\r\n    { wch: 18 }, // Attendance (Days)\r\n    { wch: 15 }, // Net Payable\r\n    { wch: 10 }, // CTC\r\n  ];\r\n\r\n  // Generate Excel file\r\n  const excelBuffer = XLSX.write(workbook, { bookType: \"xlsx\", type: \"array\" });\r\n  const blob = new Blob([excelBuffer], {\r\n    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\r\n  });\r\n\r\n  // Save the file\r\n  saveAs(blob, `Employee_Salary_${selectedMonth}_${selectedYear}.xlsx`);\r\n};\r\n\r\nexport default handleExport;\r\n"],"mappings":"AAAA,OAAO,KAAKA,IAAI,MAAM,MAAM;AAC5B,SAASC,MAAM,QAAQ,YAAY;AAEnC,MAAMC,YAAY,GAAGA,CAAA,KAAM;EACzB,MAAMC,OAAO,GAAG,CACd,QAAQ,EACR,MAAM,EACN,aAAa,EACb,KAAK,EACL,YAAY,EACZ,mBAAmB,EACnB,aAAa,EACb,KAAK,CACN;EAED,MAAMC,IAAI,GAAGC,0BAA0B,CAACC,GAAG,CAAC,CAACC,GAAG,EAAEC,KAAK,KAAK,CAC1DA,KAAK,GAAG,CAAC,EACTD,GAAG,CAACE,IAAI,EACRF,GAAG,CAACG,IAAI,IAAI,CAAC,EACbH,GAAG,CAACI,GAAG,IAAI,CAAC,EACZJ,GAAG,CAACK,UAAU,IAAI,CAAC,EACnB,GAAGL,GAAG,CAACM,cAAc,IAAIN,GAAG,CAACO,SAAS,EAAE,EACxCC,mBAAmB,CAACR,GAAG,CAAC,IAAI,CAAC,EAC7BS,YAAY,CAACT,GAAG,CAAC,IAAI,CAAC,CACvB,CAAC;EAGF,MAAMU,aAAa,GAAG,CAACd,OAAO,EAAE,GAAGC,IAAI,CAAC;EAGxC,MAAMc,SAAS,GAAGlB,IAAI,CAACmB,KAAK,CAACC,YAAY,CAACH,aAAa,CAAC;EACxD,MAAMI,QAAQ,GAAGrB,IAAI,CAACmB,KAAK,CAACG,QAAQ,CAAC,CAAC;EACtCtB,IAAI,CAACmB,KAAK,CAACI,iBAAiB,CAACF,QAAQ,EAAEH,SAAS,EAAE,iBAAiB,CAAC;EAGpEA,SAAS,CAAC,OAAO,CAAC,GAAG,CACnB;IAAEM,GAAG,EAAE;EAAE,CAAC;EAAG;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC;EAAE;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC;EAAE;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC;EAAE;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC;EAAE;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC;EAAE;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC;EAAE;EACb;IAAEA,GAAG,EAAE;EAAG,CAAC,CAAE;EAAA,CACd;;EAED;EACA,MAAMC,WAAW,GAAGzB,IAAI,CAAC0B,KAAK,CAACL,QAAQ,EAAE;IAAEM,QAAQ,EAAE,MAAM;IAAEC,IAAI,EAAE;EAAQ,CAAC,CAAC;EAC7E,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACL,WAAW,CAAC,EAAE;IACnCG,IAAI,EAAE;EACR,CAAC,CAAC;;EAEF;EACA3B,MAAM,CAAC4B,IAAI,EAAE,mBAAmBE,aAAa,IAAIC,YAAY,OAAO,CAAC;AACvE,CAAC;AAED,eAAe9B,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}